id: xss-inside-tag-top-params

info:
  name: Top Parameters - Cross-Site Scripting inside HTML tags
  author: kazet
  severity: high
  description: Cross-site scripting was discovered via a search for reflected parameter values inside HTML tags in the server response via GET-requests.
  metadata:
    max-request: 9
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 7.2
    cwe-id: CWE-79
  tags: xss,generic

http:
  - method: GET
    path:
        - '{{BaseURL}}/?plugin_status="injectable&user_name="injectable&product_id="injectable&attachment="injectable&reverse="injectable&what="injectable&img="injectable&q="injectable&set="injectable&stage="injectable&text-color="injectable&submit="injectable&input="injectable&flag="injectable&customized="injectable&id_base="injectable&noheader="injectable&phone="injectable&format="injectable&slug="injectable&start_date="injectable&server="injectable&domain="injectable&sid="injectable&logout="injectable&active="injectable&down="injectable&multi_number="injectable&nonce="injectable&post_status="injectable&status="injectable&event="injectable&description="injectable&ID="injectable&cat="injectable&output="injectable&history="injectable&admin_password="injectable&parent_id="injectable&timezone="injectable&size="injectable&password="injectable&op="injectable&to="injectable&menu-item="injectable&address="injectable&signature="injectable&all="injectable&opt="injectable&start="injectable'
        - '{{BaseURL}}/?language="injectable&target="injectable&rememberme="injectable&context="injectable&where="injectable&tablename="injectable&themes="injectable&service="injectable&metakeyinput="injectable&save="injectable&image="injectable&role="injectable&note="injectable&pwd="injectable&revision="injectable&timeout="injectable&="injectable&add="injectable&checked="injectable&tax="injectable&show="injectable&rename="injectable&source="injectable&attachments="injectable&label="injectable&number="injectable&xml="injectable&g-recaptcha-response="injectable&group_id="injectable&tables="injectable&direction="injectable&plugins="injectable&mode="injectable&w="injectable&referer="injectable&group="injectable&country="injectable&delete_widget="injectable&import="injectable&section="injectable&secret="injectable&preview="injectable&blog_public="injectable&="injectable&msg="injectable&path="injectable&new="injectable&hidden="injectable&file_name="injectable&items="injectable'
        - '{{BaseURL}}/?r="injectable&script="injectable&signup_for="injectable&users="injectable&s="injectable&timestamp="injectable&show_sticky="injectable&keyword="injectable&from="injectable&lastname="injectable&list="injectable&dbname="injectable&y="injectable&nickname="injectable&enable="injectable&post="injectable&paged="injectable&_ajax_nonce="injectable&tab="injectable&success="injectable&postid="injectable&edit="injectable&weblog_title="injectable&gid="injectable&user_email="injectable&link_url="injectable&key="injectable&src="injectable&return="injectable&last_name="injectable&st="injectable&delete="injectable&clone="injectable&rows="injectable&f="injectable&date="injectable&provider="injectable&function="injectable&type="injectable&redirect_to="injectable&menu-locations="injectable&log="injectable&id="injectable&invalid="injectable&widget_id="injectable&l="injectable&url="injectable&host="injectable&tag_ID="injectable&stylesheet="injectable'
        - '{{BaseURL}}/?site_id="injectable&trashed="injectable&city="injectable&filename="injectable&update="injectable&fid="injectable&u="injectable&state="injectable&cid="injectable&ids="injectable&create="injectable&method="injectable&modify="injectable&alias="injectable&admin="injectable&test="injectable&color="injectable&mail="injectable&csrf_token="injectable&preview_nonce="injectable&day="injectable&parent="injectable&item="injectable&email="injectable&captcha="injectable&fname="injectable&html="injectable&preview_id="injectable&tid="injectable&db_port="injectable&login="injectable&g="injectable&order="injectable&port="injectable&pass1="injectable&m="injectable&t="injectable&action="injectable&out_trade_no="injectable&level="injectable&trigger="injectable&gmt_offset="injectable&category="injectable&time="injectable&sidebar="injectable&next="injectable&code="injectable&overwrite="injectable&timezone_string="injectable&option="injectable'
        - '{{BaseURL}}/?query="injectable&mobile="injectable&userid="injectable&json="injectable&filter="injectable&activated="injectable&md5="injectable&order_id="injectable&selection="injectable&ajax="injectable&copy="injectable&comment_status="injectable&field_id="injectable&tags="injectable&updated="injectable&do="injectable&untrashed="injectable&message="injectable&limit="injectable&reason="injectable&sticky="injectable&profile="injectable&debug="injectable&v="injectable&dump="injectable&width="injectable&field="injectable&columns="injectable&enabled="injectable&go="injectable&replytocom="injectable&db_name="injectable&comments="injectable&o="injectable&edit-menu-item="injectable&dir="injectable&groups="injectable&end_date="injectable&tax_input="injectable&author="injectable&settings="injectable&h="injectable&check="injectable&activate="injectable&features="injectable&shortcode="injectable&confirm="injectable&link="injectable&folder="injectable&linkcheck="injectable'
        - '{{BaseURL}}/?val="injectable&tag="injectable&page="injectable&pass="injectable&oauth_token="injectable&redirect="injectable&client_id="injectable&hash="injectable&auth="injectable&first_name="injectable&cookie="injectable&deleted="injectable&n="injectable&location="injectable&wp_screen_options="injectable&orderby="injectable&site="injectable&menu="injectable&destination="injectable&offset="injectable&dismiss="injectable&hostname="injectable&notes="injectable&newcontent="injectable&name="injectable&select="injectable&post_title="injectable&post_type="injectable&search="injectable&_wpnonce="injectable&d="injectable&body="injectable&send="injectable&end="injectable&screen="injectable&ref="injectable&class="injectable&oauth_verifier="injectable&comment="injectable&user="injectable&error="injectable&category_id="injectable&disabled="injectable&firstname="injectable&user_login="injectable&table="injectable&object="injectable&post_ID="injectable&text="injectable&term="injectable'
        - '{{BaseURL}}/?new_role="injectable&x="injectable&desc="injectable&reset="injectable&user_id="injectable&task="injectable&del="injectable&drop="injectable&passwd="injectable&export="injectable&cancel="injectable&month="injectable&directory="injectable&post_id="injectable&remove="injectable&c="injectable&metakeyselect="injectable&value="injectable&newname="injectable&range="injectable&prefix="injectable&sort="injectable&year="injectable&excerpt="injectable&uid="injectable&action2="injectable&ns="injectable&attachment_id="injectable&db="injectable&position="injectable&pid="injectable&cmd="injectable&charset="injectable&request="injectable&part="injectable&config="injectable&num="injectable&act="injectable&upload="injectable&insert="injectable&taxonomy="injectable&data="injectable&step="injectable&command="injectable&amount="injectable&content="injectable&fields="injectable&foo="injectable&dl="injectable&keywords="injectable'
        - '{{BaseURL}}/?comment_ID="injectable&module="injectable&widget="injectable&oitar="injectable&lang="injectable&e="injectable&database="injectable&token="injectable&template="injectable&a="injectable&_wp_http_referer="injectable&sql="injectable&height="injectable&params="injectable&subject="injectable&up="injectable&uname="injectable&widget-id="injectable&settings-updated="injectable&version="injectable&mod="injectable&media="injectable&count="injectable&view="injectable&string="injectable&form="injectable&admin_email="injectable&theme="injectable&download="injectable&pass2="injectable&link_id="injectable&loggedout="injectable&username="injectable&noconfirmation="injectable&move="injectable&_method="injectable&index="injectable&meta="injectable&locale="injectable&plugin="injectable&info="injectable&callback="injectable&i="injectable&file="injectable&api_key="injectable&options="injectable&checkemail="injectable&ip="injectable&blog="injectable&page_id="injectable'
        - '{{BaseURL}}/?post_mime_type="injectable&title="injectable&files="injectable&allusers="injectable&p="injectable&plugin_status="injectable&user_name="injectable&product_id="injectable&attachment="injectable&reverse="injectable&what="injectable&img="injectable&q="injectable&set="injectable&stage="injectable&text-color="injectable&submit="injectable&input="injectable&flag="injectable&customized="injectable&id_base="injectable&noheader="injectable&phone="injectable'

    host-redirects: true
    max-redirects: 1
    matchers-condition: and
    matchers:
      # MediaWiki and LimeSurvey are a source of false positives
      - type: word
        part: body
        words:
          - '<meta name="generator" content="MediaWiki'
          - '<meta name="generator" content="LimeSurvey'
          - '<title>phpMyAdmin</title>'
        negative: true

      - type: regex
        part: body
        regex:
          - '<[^>]*"injectable[^>]*>'

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200
