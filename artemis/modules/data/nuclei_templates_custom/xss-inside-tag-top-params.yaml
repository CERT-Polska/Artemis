id: xss-inside-tag-top-params

info:
  name: Top Parameters - Cross-Site Scripting inside HTML tags
  author: kazet
  severity: high
  description: Cross-site scripting was discovered via a search for reflected parameter values inside HTML tags in the server response via GET-requests.
  metadata:
    max-request: 9
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 7.2
    cwe-id: CWE-79
  tags: xss,generic

http:
  - method: GET
    path:
        - '{{BaseURL}}/?cmd=%22injectable&themes=%22injectable&json=%22injectable&api_key=%22injectable&author=%22injectable&task=%22injectable&hostname=%22injectable&id=%22injectable&color=%22injectable&admin_password=%22injectable&trashed=%22injectable&set=%22injectable&insert=%22injectable&trigger=%22injectable&timestamp=%22injectable&tags=%22injectable&cat=%22injectable&range=%22injectable&f=%22injectable&next=%22injectable&enabled=%22injectable&fid=%22injectable&checkemail=%22injectable&destination=%22injectable&submit=%22injectable&sort=%22injectable&user=%22injectable&path=%22injectable&field_id=%22injectable&csrf_token=%22injectable&uid=%22injectable&gmt_offset=%22injectable&index=%22injectable&pid=%22injectable&upload=%22injectable&drop=%22injectable&foo=%22injectable&excerpt=%22injectable&product_id=%22injectable&noheader=%22injectable&day=%22injectable&oitar=%22injectable&export=%22injectable&text=%22injectable&last_name=%22injectable'
        - '{{BaseURL}}/?auth=%22injectable&secret=%22injectable&taxonomy=%22injectable&p=%22injectable&role=%22injectable&s=%22injectable&g=%22injectable&site_id=%22injectable&ns=%22injectable&city=%22injectable&st=%22injectable&copy=%22injectable&screen=%22injectable&userid=%22injectable&output=%22injectable&end_date=%22injectable&id_base=%22injectable&download=%22injectable&_wp_http_referer=%22injectable&oauth_token=%22injectable&email=%22injectable&data=%22injectable&ref=%22injectable&post_ID=%22injectable&d=%22injectable&success=%22injectable&server=%22injectable&link_id=%22injectable&selection=%22injectable&db_port=%22injectable&template=%22injectable&lang=%22injectable&debug=%22injectable&uname=%22injectable&alias=%22injectable&section=%22injectable&date=%22injectable&orderby=%22injectable&user_id=%22injectable&postid=%22injectable&l=%22injectable&year=%22injectable&subject=%22injectable&timeout=%22injectable&mode=%22injectable'
        - '{{BaseURL}}/?checked=%22injectable&token=%22injectable&address=%22injectable&sidebar=%22injectable&menu-locations=%22injectable&client_id=%22injectable&db_name=%22injectable&offset=%22injectable&action=%22injectable&domain=%22injectable&columns=%22injectable&updated=%22injectable&edit=%22injectable&mod=%22injectable&delete=%22injectable&sticky=%22injectable&remove=%22injectable&del=%22injectable&edit-menu-item=%22injectable&html=%22injectable&count=%22injectable&opt=%22injectable&preview_nonce=%22injectable&request=%22injectable&size=%22injectable&down=%22injectable&show_sticky=%22injectable&context=%22injectable&weblog_title=%22injectable&do=%22injectable&q=%22injectable&query=%22injectable&dump=%22injectable&revision=%22injectable&comment_ID=%22injectable&pass=%22injectable&nonce=%22injectable&folder=%22injectable&action2=%22injectable&preview=%22injectable&ids=%22injectable&rename=%22injectable&active=%22injectable&signup_for=%22injectable'
        - '{{BaseURL}}/?passwd=%22injectable&image=%22injectable&widget=%22injectable&metakeyselect=%22injectable&stage=%22injectable&dbname=%22injectable&src=%22injectable&label=%22injectable&_wpnonce=%22injectable&_method=%22injectable&file=%22injectable&message=%22injectable&redirect=%22injectable&comment=%22injectable&disabled=%22injectable&blog_public=%22injectable&cookie=%22injectable&linkcheck=%22injectable&where=%22injectable&list=%22injectable&cancel=%22injectable&type=%22injectable&format=%22injectable&post=%22injectable&tag=%22injectable&widget_id=%22injectable&order_id=%22injectable&fields=%22injectable&page=%22injectable&first_name=%22injectable&source=%22injectable&term=%22injectable&prefix=%22injectable&username=%22injectable&item=%22injectable&config=%22injectable&blog=%22injectable&callback=%22injectable&timezone=%22injectable&clone=%22injectable&msg=%22injectable&tablename=%22injectable&user_email=%22injectable&category=%22injectable&invalid=%22injectable'
        - '{{BaseURL}}/?loggedout=%22injectable&code=%22injectable&e=%22injectable&noconfirmation=%22injectable&position=%22injectable&locale=%22injectable&widget-id=%22injectable&post_title=%22injectable&create=%22injectable&check=%22injectable&oauth_verifier=%22injectable&return=%22injectable&act=%22injectable&add=%22injectable&script=%22injectable&post_type=%22injectable&month=%22injectable&preview_id=%22injectable&a=%22injectable&confirm=%22injectable&page_id=%22injectable&new_role=%22injectable&part=%22injectable&stylesheet=%22injectable&table=%22injectable&start=%22injectable&media=%22injectable&description=%22injectable&val=%22injectable&deleted=%22injectable&signature=%22injectable&version=%22injectable&input=%22injectable&directory=%22injectable&captcha=%22injectable&attachment=%22injectable&phone=%22injectable&r=%22injectable&to=%22injectable&modify=%22injectable&slug=%22injectable&wp_screen_options=%22injectable&field=%22injectable&plugins=%22injectable&content=%22injectable'
        - '{{BaseURL}}/?new=%22injectable&ip=%22injectable&newcontent=%22injectable&n=%22injectable&settings=%22injectable&user_name=%22injectable&site=%22injectable&keywords=%22injectable&from=%22injectable&desc=%22injectable&users=%22injectable&paged=%22injectable&up=%22injectable&tables=%22injectable&comments=%22injectable&metakeyinput=%22injectable&enable=%22injectable&form=%22injectable&timezone_string=%22injectable&pwd=%22injectable&limit=%22injectable&go=%22injectable&untrashed=%22injectable&url=%22injectable&database=%22injectable&view=%22injectable&key=%22injectable&params=%22injectable&newname=%22injectable&keyword=%22injectable&filter=%22injectable&files=%22injectable&plugin_status=%22injectable&number=%22injectable&amount=%22injectable&target=%22injectable&port=%22injectable&what=%22injectable&tax_input=%22injectable&provider=%22injectable&attachment_id=%22injectable&plugin=%22injectable&tag_ID=%22injectable&dir=%22injectable&pass2=%22injectable'
        - '{{BaseURL}}/?mail=%22injectable&login=%22injectable&width=%22injectable&body=%22injectable&import=%22injectable&md5=%22injectable&group_id=%22injectable&features=%22injectable&option=%22injectable&password=%22injectable&mobile=%22injectable&dl=%22injectable&select=%22injectable&name=%22injectable&direction=%22injectable&search=%22injectable&_ajax_nonce=%22injectable&info=%22injectable&step=%22injectable&settings-updated=%22injectable&m=%22injectable&user_login=%22injectable&event=%22injectable&start_date=%22injectable&height=%22injectable&rememberme=%22injectable&level=%22injectable&admin_email=%22injectable&options=%22injectable&comment_status=%22injectable&ID=%22injectable&object=%22injectable&filename=%22injectable&x=%22injectable&g-recaptcha-response=%22injectable&class=%22injectable&sid=%22injectable&out_trade_no=%22injectable&link_url=%22injectable&save=%22injectable&reason=%22injectable&o=%22injectable&time=%22injectable&w=%22injectable&note=%22injectable'
        - '{{BaseURL}}/?op=%22injectable&post_mime_type=%22injectable&tab=%22injectable&theme=%22injectable&hash=%22injectable&firstname=%22injectable&t=%22injectable&groups=%22injectable&show=%22injectable&v=%22injectable&all=%22injectable&status=%22injectable&db=%22injectable&redirect_to=%22injectable&shortcode=%22injectable&tid=%22injectable&country=%22injectable&img=%22injectable&history=%22injectable&i=%22injectable&customized=%22injectable&xml=%22injectable&c=%22injectable&menu-item=%22injectable&profile=%22injectable&activate=%22injectable&command=%22injectable&allusers=%22injectable&tax=%22injectable&error=%22injectable&nickname=%22injectable&move=%22injectable&multi_number=%22injectable&h=%22injectable&test=%22injectable&link=%22injectable&pass1=%22injectable&num=%22injectable&parent=%22injectable&text-color=%22injectable&gid=%22injectable&flag=%22injectable&post_id=%22injectable&reverse=%22injectable&fname=%22injectable'
        - '{{BaseURL}}/?language=%22injectable&charset=%22injectable&delete_widget=%22injectable&replytocom=%22injectable&file_name=%22injectable&menu=%22injectable&update=%22injectable&dismiss=%22injectable&y=%22injectable&title=%22injectable&service=%22injectable&post_status=%22injectable&overwrite=%22injectable&hidden=%22injectable&rows=%22injectable&ajax=%22injectable&referer=%22injectable&function=%22injectable&cid=%22injectable&group=%22injectable&state=%22injectable&u=%22injectable&order=%22injectable&meta=%22injectable&method=%22injectable&lastname=%22injectable&send=%22injectable&attachments=%22injectable&reset=%22injectable&items=%22injectable&notes=%22injectable&string=%22injectable&location=%22injectable&logout=%22injectable&host=%22injectable&activated=%22injectable&module=%22injectable&parent_id=%22injectable&end=%22injectable&category_id=%22injectable&sql=%22injectable&log=%22injectable&value=%22injectable&admin=%22injectable'
        - '{{BaseURL}}/?cmd=%22injectable&themes=%22injectable&json=%22injectable&api_key=%22injectable&author=%22injectable&task=%22injectable&hostname=%22injectable&id=%22injectable&color=%22injectable&admin_password=%22injectable&trashed=%22injectable&set=%22injectable&insert=%22injectable&trigger=%22injectable&timestamp=%22injectable&tags=%22injectable&cat=%22injectable&range=%22injectable'

    host-redirects: true
    max-redirects: 1
    matchers-condition: and
    matchers:
      # MediaWiki and LimeSurvey are a source of false positives
      - type: word
        part: body
        words:
          - '<meta name="generator" content="MediaWiki'
          - '<meta name="generator" content="LimeSurvey'
          - '<title>phpMyAdmin</title>'
        negative: true

      - type: regex
        part: body
        regex:
          - '<[^>]*"injectable[^>]*>'

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200
